<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up</title>

    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="main-container register">
        <div class="inner-container register">
            <h2>Register</h2>
            <form action="/register" method = "POST" enctype="multipart/form-data">
                <label>
                    Full Name: 
                    <input type="text" required maxlength="50" width="100" name="fullname" id="fullname" >
                </label>

                <label>
                    Username: 
                    <input type="text" required maxlength="25" width="100" name="username" id="username">
                </label>
                <div class="error-msg username"><%=user_error%></div>

                <label>
                    Email Id: 
                    <input type="email"  maxlength="30" width="100" name="email" id="email">
                </label>
                <div class="error-msg email"><%= email_error %></div>

                <label>
                    Password: 
                    <input type="password" required maxlength="30" minlength="5" width="100" name="password" id="password" >
                </label>
                <div class="error-msg password"><%= pass_error %></div>

                <label>
                    Profile Photo:
                    <input type="file" accept="image/*" name="file"  id="photo" required>
                </label>
            

                <input type="submit" value="Submit">


            </form>
        </div>
    </div>
    <script>
        /*
        
        
        const form = document.querySelector('form');
        const user_error_msg = document.querySelector('.error-msg.username');
        const email_error_msg = document.querySelector('.error-msg.email');
        const pass_error_msg = document.querySelector('.error-msg.password');
        form.addEventListener('submit',async (e)=>{
            e.preventDefault();
            const fullname = document.querySelector('#fullname').value;
            const username = document.querySelector('#username').value;
            const email = document.querySelector('#email').value;
            const password = document.querySelector('#password').value;
            const photo = document.querySelector('#photo').value.split("\\").pop();
            
            try {
                const res = await fetch('/register', { 
                    method: 'POST', 
                    body: JSON.stringify({ email, password,fullname,username}),
                    file : JSON.stringify({photo}),
                    headers: {'Content-Type': 'application/json'}
                });
                const data = await res.json();
                console.log("Reached Here")
                console.log("Data\n"+data);
                if (data.errors) {
                    email_error_msg.textContent = data.errors.email;
                    pass_error_msg.textContent = data.errors.password;
                    user_error_msg.textContent = data.errors.username;
                }
                if(data.user){
                    console.log("In data.user");
                    location.assign('/login');
                }
            }
            catch (err) {
                console.log(err);
            }
          
        })*/
    </script>

</body>
</html>